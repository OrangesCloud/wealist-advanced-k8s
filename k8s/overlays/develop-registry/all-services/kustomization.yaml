# =============================================================================
# Kustomization - All Services (Local Registry Mode)
# =============================================================================
# 로컬 레지스트리(localhost:5001)를 사용하는 모든 서비스 배포
#
# 이미지: localhost:5001/<service>:latest

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  # Infrastructure (includes namespace)
  - ../../../../infrastructure/overlays/develop

  # Shared config & ingress
  - ../../../base/shared
  - ingress.yaml

  # Backend Services (base only, we override images here)
  - ../../../../services/auth-service/k8s/base
  - ../../../../services/user-service/k8s/base
  - ../../../../services/board-service/k8s/base
  - ../../../../services/chat-service/k8s/base
  - ../../../../services/noti-service/k8s/base
  - ../../../../services/storage-service/k8s/base
  - ../../../../services/video-service/k8s/base

  # Frontend
  - ../../../../services/frontend/k8s/base

# Override images to use local registry
images:
  - name: auth-service
    newName: localhost:5001/auth-service
    newTag: latest
  - name: user-service
    newName: localhost:5001/user-service
    newTag: latest
  - name: board-service
    newName: localhost:5001/board-service
    newTag: latest
  - name: chat-service
    newName: localhost:5001/chat-service
    newTag: latest
  - name: noti-service
    newName: localhost:5001/noti-service
    newTag: latest
  - name: storage-service
    newName: localhost:5001/storage-service
    newTag: latest
  - name: video-service
    newName: localhost:5001/video-service
    newTag: latest
  - name: frontend
    newName: localhost:5001/frontend
    newTag: latest

# Set namespace for all resources
namespace: wealist-dev

# Common labels
labels:
  - pairs:
      app.kubernetes.io/env: develop
      app.kubernetes.io/registry: local
    includeSelectors: false
